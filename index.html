<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D√ºsseldorf Flughafen - Live Flugdaten</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <meta name="description" content="Live Flugdaten vom D√ºsseldorf Flughafen - Ank√ºnfte, Abfl√ºge und Sichtkontrollen">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            margin: 0;
            padding: 0;
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;
        const { 
            Plane, Star, Search, Clock, MapPin, RefreshCw, Wifi, WifiOff, 
            Users, AlertCircle, Filter, ChevronDown, ChevronUp, X 
        } = lucide;

        const FlugInfoApp = () => {
            const [activeTab, setActiveTab] = useState('ank√ºnfte');
            const [searchTerm, setSearchTerm] = useState('');
            const [favorites, setFavorites] = useState([]);
            const [realFlights, setRealFlights] = useState([]);
            const [loading, setLoading] = useState(false);
            const [lastUpdate, setLastUpdate] = useState(null);
            const [error, setError] = useState(null);
            const [showSearch, setShowSearch] = useState(false);
            const [selectedFlightsForControl, setSelectedFlightsForControl] = useState(new Set());
            const [selectedAirports, setSelectedAirports] = useState(new Set());
            const [showFilters, setShowFilters] = useState(false);
            const [bemerkungen, setBemerkungen] = useState({});

            // Flugh√§fen f√ºr Sichtkontrollen (IATA-Codes) - vorausgew√§hlt
            const DEFAULT_SICHTKONTROLL_AIRPORTS = {
                'ATH': 'Athen', 'SKG': 'Thessaloniki', 'HER': 'Heraklion', 'RHO': 'Rhodos',
                'MAD': 'Madrid', 'BCN': 'Barcelona', 'PMI': 'Palma', 'AGP': 'M√°laga',
                'LPA': 'Las Palmas', 'VLC': 'Valencia',
                'FCO': 'Rom Fiumicino', 'MXP': 'Mailand Malpensa', 'NAP': 'Neapel',
                'VCE': 'Venedig', 'BLQ': 'Bologna', 'CTA': 'Catania',
                'CDG': 'Paris CDG', 'ORY': 'Paris Orly', 'NCE': 'Nizza',
                'LYS': 'Lyon', 'MRS': 'Marseille',
                'LIS': 'Lissabon', 'OPO': 'Porto', 'FAO': 'Faro',
                'WAW': 'Warschau', 'KRK': 'Krakau', 'GDN': 'Danzig'
            };

            // Non-Schengen L√§nder f√ºr Markierung
            const NON_SCHENGEN_COUNTRIES = [
                'United States', 'Canada', 'United Kingdom', 'Turkey', 'Russia', 
                'China', 'Japan', 'India', 'Thailand', 'United Arab Emirates',
                'Qatar', 'Kuwait', 'Saudi Arabia', 'Egypt', 'Morocco', 'Tunisia',
                'Serbia', 'Bosnia and Herzegovina', 'North Macedonia', 'Albania',
                'Ukraine', 'Belarus', 'Moldova'
            ];

            const fetchRealFlightData = async () => {
                setLoading(true);
                setError(null);
                
                try {
                    console.log('Lade echte Flugdaten von AviationStack...');
                    
                    // Sowohl Abfl√ºge als auch Ank√ºnfte laden
                    const [departuresResponse, arrivalsResponse] = await Promise.all([
                        fetch('https://api.aviationstack.com/v1/flights?access_key=demo&dep_iata=DUS&limit=25'),
                        fetch('https://api.aviationstack.com/v1/flights?access_key=demo&arr_iata=DUS&limit=25')
                    ]);

                    const flights = [];

                    // Abfl√ºge verarbeiten
                    if (departuresResponse.ok) {
                        const depData = await departuresResponse.json();
                        if (depData?.data) {
                            depData.data.forEach(flight => {
                                if (flight.departure?.iata === 'DUS') {
                                    flights.push({
                                        id: flight.flight?.iata || flight.flight?.icao || Math.random().toString(36),
                                        flugnummer: flight.flight?.iata || flight.flight?.icao || 'N/A',
                                        airline: flight.airline?.name || 'Unbekannt',
                                        zielort: flight.arrival?.airport || 'Unbekannt',
                                        zielCode: flight.arrival?.iata || flight.arrival?.icao || 'N/A',
                                        abflug: flight.departure?.scheduled ? 
                                            new Date(flight.departure.scheduled).toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' }) : 'N/A',
                                        abflugErwartet: flight.departure?.estimated ? 
                                            new Date(flight.departure.estimated).toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' }) : null,
                                        gate: flight.departure?.gate || 'TBA',
                                        status: getFlightStatus(flight.flight_status),
                                        statusColor: getStatusColor(flight.flight_status),
                                        versp√§tung: getDelay(flight.departure?.scheduled, flight.departure?.estimated),
                                        isLanding: false,
                                        land: flight.arrival?.country || 'Unbekannt'
                                    });
                                }
                            });
                        }
                    }

                    // Ank√ºnfte verarbeiten
                    if (arrivalsResponse.ok) {
                        const arrData = await arrivalsResponse.json();
                        if (arrData?.data) {
                            arrData.data.forEach(flight => {
                                if (flight.arrival?.iata === 'DUS') {
                                    flights.push({
                                        id: flight.flight?.iata || flight.flight?.icao || Math.random().toString(36),
                                        flugnummer: flight.flight?.iata || flight.flight?.icao || 'N/A',
                                        airline: flight.airline?.name || 'Unbekannt',
                                        herkunft: flight.departure?.airport || 'Unbekannt',
                                        herkunftCode: flight.departure?.iata || flight.departure?.icao || 'N/A',
                                        ankunft: flight.arrival?.scheduled ? 
                                            new Date(flight.arrival.scheduled).toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' }) : 'N/A',
                                        ankunftErwartet: flight.arrival?.estimated ? 
                                            new Date(flight.arrival.estimated).toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' }) : null,
                                        gate: flight.arrival?.gate || 'TBA',
                                        status: getFlightStatus(flight.flight_status),
                                        statusColor: getStatusColor(flight.flight_status),
                                        versp√§tung: getDelay(flight.arrival?.scheduled, flight.arrival?.estimated),
                                        passagiere: getPassengerEstimate(flight.aircraft?.iata),
                                        isLanding: true,
                                        land: flight.departure?.country || 'Unbekannt'
                                    });
                                }
                            });
                        }
                    }

                    if (flights.length > 0) {
                        setRealFlights(flights);
                        setLastUpdate(new Date());
                        setError(null);
                    } else {
                        throw new Error('Keine aktuellen Flugdaten verf√ºgbar');
                    }

                } catch (error) {
                    console.error('Fehler beim Laden der Flugdaten:', error);
                    setError('Keine echten Flugdaten verf√ºgbar. Bitte sp√§ter erneut versuchen.');
                    setRealFlights([]);
                } finally {
                    setLoading(false);
                }
            };

            const getFlightStatus = (status) => {
                switch (status) {
                    case 'scheduled': return 'Geplant';
                    case 'active': return 'Aktiv';
                    case 'landed': return 'Gelandet';
                    case 'cancelled': return 'Storniert';
                    case 'incident': return 'Zwischenfall';
                    case 'diverted': return 'Umgeleitet';
                    default: return 'Unbekannt';
                }
            };

            const getStatusColor = (status) => {
                switch (status) {
                    case 'scheduled': return 'text-blue-600';
                    case 'active': return 'text-green-600';
                    case 'landed': return 'text-green-600';
                    case 'cancelled': return 'text-red-600';
                    case 'incident': return 'text-red-600';
                    case 'diverted': return 'text-orange-600';
                    default: return 'text-gray-600';
                }
            };

            const getDelay = (scheduled, estimated) => {
                if (!scheduled || !estimated) return null;
                const scheduledTime = new Date(scheduled);
                const estimatedTime = new Date(estimated);
                const diffMinutes = Math.round((estimatedTime - scheduledTime) / (1000 * 60));
                return diffMinutes > 5 ? diffMinutes : null;
            };

            const getPassengerEstimate = (aircraftCode) => {
                const aircraftCapacity = {
                    'A319': 140, 'A320': 160, 'A321': 200, 'A330': 280, 'A350': 350,
                    'B737': 150, 'B738': 160, 'B739': 180, 'B767': 250, 'B777': 350,
                    'A220': 130, 'E190': 100, 'CRJ9': 90, 'AT72': 70
                };
                
                const capacity = aircraftCapacity[aircraftCode] || 160;
                return Math.floor(capacity * (0.7 + Math.random() * 0.25));
            };

            useEffect(() => {
                fetchRealFlightData();
                const interval = setInterval(fetchRealFlightData, 120000);
                setSelectedAirports(new Set(Object.keys(DEFAULT_SICHTKONTROLL_AIRPORTS)));
                return () => clearInterval(interval);
            }, []);

            const toggleFavorite = (flugId) => {
                setFavorites(prev => 
                    prev.includes(flugId) 
                        ? prev.filter(id => id !== flugId)
                        : [...prev, flugId]
                );
            };

            const isFavorite = (flugId) => favorites.includes(flugId);

            const updateBemerkung = (flugId, bemerkung) => {
                setBemerkungen(prev => ({
                    ...prev,
                    [flugId]: bemerkung
                }));
            };

            const getBemerkung = (flugId) => bemerkungen[flugId] || '';

            const toggleFlightForControl = (flugId) => {
                setSelectedFlightsForControl(prev => {
                    const newSet = new Set(prev);
                    if (newSet.has(flugId)) {
                        newSet.delete(flugId);
                    } else {
                        newSet.add(flugId);
                    }
                    return newSet;
                });
            };

            const toggleAirportForControl = (airportCode) => {
                setSelectedAirports(prev => {
                    const newSet = new Set(prev);
                    if (newSet.has(airportCode)) {
                        newSet.delete(airportCode);
                    } else {
                        newSet.add(airportCode);
                    }
                    return newSet;
                });
            };

            const getArrivingFlights = () => {
                return realFlights.filter(flight => 
                    flight.isLanding && 
                    (flight.gate?.startsWith('A') || flight.gate?.startsWith('B') || flight.gate === 'TBA')
                );
            };

            const isNonSchengenCountry = (country) => {
                return NON_SCHENGEN_COUNTRIES.includes(country);
            };

            const filteredFlights = useMemo(() => {
                if (!realFlights.length) return [];
                
                let flights = [];
                
                if (activeTab === 'abfl√ºge') {
                    flights = realFlights.filter(flight => !flight.isLanding);
                } else if (activeTab === 'ank√ºnfte') {
                    flights = realFlights.filter(flight => flight.isLanding);
                } else if (activeTab === 'sichtkontrollen') {
                    const airportSelectedFlights = realFlights.filter(flight => 
                        flight.isLanding && 
                        flight.herkunftCode &&
                        selectedAirports.has(flight.herkunftCode) &&
                        (flight.gate?.startsWith('A') || flight.gate?.startsWith('B') || flight.gate === 'TBA')
                    );
                    
                    const manuallySelectedFlights = realFlights.filter(flight =>
                        selectedFlightsForControl.has(flight.id)
                    );
                    
                    const combinedFlights = [...airportSelectedFlights];
                    manuallySelectedFlights.forEach(flight => {
                        if (!combinedFlights.find(f => f.id === flight.id)) {
                            combinedFlights.push(flight);
                        }
                    });
                    
                    flights = combinedFlights;
                } else if (activeTab === 'favoriten') {
                    flights = realFlights.filter(flight => favorites.includes(flight.id));
                }
                
                if (!searchTerm) return flights.slice(0, 20);
                
                return flights.filter(flight => 
                    flight.flugnummer.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    (flight.zielort && flight.zielort.toLowerCase().includes(searchTerm.toLowerCase())) ||
                    (flight.herkunft && flight.herkunft.toLowerCase().includes(searchTerm.toLowerCase())) ||
                    (flight.zielCode && flight.zielCode.toLowerCase().includes(searchTerm.toLowerCase())) ||
                    (flight.herkunftCode && flight.herkunftCode.toLowerCase().includes(searchTerm.toLowerCase())) ||
                    flight.airline.toLowerCase().includes(searchTerm.toLowerCase())
                ).slice(0, 20);
            }, [activeTab, searchTerm, favorites, realFlights, selectedFlightsForControl, selectedAirports]);

            const FlugKarte = ({ flug }) => (
                <div className="bg-white rounded-lg shadow-sm border border-gray-200 mb-3 p-4">
                    <div className="flex justify-between items-start mb-3">
                        <div className="flex items-center space-x-3 flex-1 min-w-0">
                            <div className="bg-blue-100 p-2 rounded-full">
                                <Plane className="w-4 h-4 text-blue-600" />
                            </div>
                            <div className="min-w-0 flex-1">
                                <div className="flex items-center space-x-2">
                                    <h3 className="font-bold text-lg text-gray-800 truncate">{flug.flugnummer}</h3>
                                    {flug.land && isNonSchengenCountry(flug.land) && (
                                        <span className="px-2 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full whitespace-nowrap">
                                            Non-Schengen
                                        </span>
                                    )}
                                    {flug.versp√§tung && (
                                        <span className="px-2 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full whitespace-nowrap">
                                            +{flug.versp√§tung}min
                                        </span>
                                    )}
                                </div>
                                <p className="text-sm text-gray-500 truncate">{flug.airline}</p>
                                {activeTab === 'sichtkontrollen' && flug.land && (
                                    <p className="text-xs text-blue-600 font-medium">üìç {flug.land}</p>
                                )}
                            </div>
                        </div>
                        <button
                            onClick={() => toggleFavorite(flug.id)}
                            className="p-2 rounded-full hover:bg-gray-100 transition-colors flex-shrink-0"
                        >
                            {isFavorite(flug.id) ? 
                                <Star className="w-5 h-5 text-yellow-500 fill-current" /> : 
                                <Star className="w-5 h-5 text-gray-400" />
                            }
                        </button>
                    </div>

                    <div className="grid grid-cols-2 gap-4 mb-3">
                        <div className="flex items-center space-x-2">
                            <MapPin className="w-4 h-4 text-gray-400" />
                            <div className="min-w-0 flex-1">
                                <p className="text-xs text-gray-500">
                                    {flug.isLanding ? 'Von' : 'Nach'}
                                </p>
                                <p className="font-semibold text-sm text-gray-800 truncate">
                                    {flug.zielort || flug.herkunft}
                                </p>
                                <p className="text-xs text-gray-500">
                                    {flug.zielCode || flug.herkunftCode}
                                </p>
                            </div>
                        </div>
                        
                        <div className="flex items-center space-x-2">
                            <Clock className="w-4 h-4 text-gray-400" />
                            <div className="min-w-0 flex-1">
                                <p className="text-xs text-gray-500">
                                    {flug.isLanding ? 'Ankunft' : 'Abflug'}
                                </p>
                                <p className="font-bold text-sm text-gray-800">
                                    {flug.abflug || flug.ankunft}
                                </p>
                                {(flug.abflugErwartet || flug.ankunftErwartet) && (
                                    <p className="text-xs text-orange-600">
                                        Erwartet: {flug.abflugErwartet || flug.ankunftErwartet}
                                    </p>
                                )}
                            </div>
                        </div>
                    </div>

                    <div className="flex justify-between items-center pt-3 border-t border-gray-100">
                        <div className="flex items-center space-x-4">
                            <div className="text-sm">
                                <span className="text-gray-500">Gate: </span>
                                <span className="font-semibold text-gray-800">{flug.gate}</span>
                            </div>
                            
                            {flug.isLanding && flug.passagiere && (
                                <div className="flex items-center space-x-1 text-sm">
                                    <Users className="w-4 h-4 text-gray-400" />
                                    <span className="font-semibold text-gray-800">{flug.passagiere}</span>
                                </div>
                            )}
                        </div>
                        
                        <div className="text-sm">
                            <span className={`font-semibold ${flug.statusColor}`}>
                                {flug.status}
                            </span>
                        </div>
                    </div>

                    {activeTab === 'sichtkontrollen' && (
                        <div className="mt-3 pt-3 border-t border-gray-200">
                            <label className="block text-xs font-medium text-gray-700 mb-1">
                                Bemerkungen zur Sichtkontrolle:
                            </label>
                            <textarea
                                value={getBemerkung(flug.id)}
                                onChange={(e) => updateBemerkung(flug.id, e.target.value)}
                                placeholder="Bemerkungen eingeben..."
                                className="w-full p-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                                rows="2"
                            />
                        </div>
                    )}
                </div>
            );

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* Mobile Header */}
                    <div className="bg-gradient-to-r from-blue-600 to-blue-800 text-white shadow-lg sticky top-0 z-50">
                        <div className="px-4 py-4">
                            <div className="flex justify-between items-center">
                                <div>
                                    <h1 className="text-xl font-bold">DUS Flughafen</h1>
                                    <p className="text-xs text-blue-100">Live Flugdaten</p>
                                </div>
                                <div className="flex items-center space-x-2">
                                    <button
                                        onClick={() => setShowSearch(!showSearch)}
                                        className="p-2 bg-blue-500 hover:bg-blue-400 rounded-lg transition-colors"
                                    >
                                        <Search className="w-4 h-4" />
                                    </button>
                                    <button
                                        onClick={fetchRealFlightData}
                                        disabled={loading}
                                        className="p-2 bg-blue-500 hover:bg-blue-400 disabled:bg-blue-700 rounded-lg transition-colors"
                                    >
                                        <RefreshCw className={`w-4 h-4 ${loading ? 'animate-spin' : ''}`} />
                                    </button>
                                </div>
                            </div>

                            {showSearch && (
                                <div className="mt-3">
                                    <div className="relative">
                                        <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-blue-300" />
                                        <input
                                            type="text"
                                            placeholder="Flug suchen..."
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                            className="w-full pl-10 pr-4 py-2 text-sm bg-blue-700 text-white placeholder-blue-300 border border-blue-500 rounded-lg focus:ring-2 focus:ring-white focus:border-transparent"
                                        />
                                        <button
                                            onClick={() => setShowSearch(false)}
                                            className="absolute right-2 top-1/2 transform -translate-y-1/2 p-1"
                                        >
                                            <X className="w-4 h-4 text-blue-300" />
                                        </button>
                                    </div>
                                </div>
                            )}

                            <div className="mt-2 flex items-center justify-between text-xs">
                                <div className="flex items-center space-x-2">
                                    {error ? (
                                        <WifiOff className="w-3 h-3 text-red-300" />
                                    ) : (
                                        <Wifi className="w-3 h-3 text-green-300" />
                                    )}
                                    <span className="text-blue-100">
                                        {loading ? 'L√§dt...' : error ? 'Offline' : 'Live'}
                                    </span>
                                </div>
                                {lastUpdate && (
                                    <span className="text-blue-200">
                                        {lastUpdate.toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' })}
                                    </span>
                                )}
                            </div>
                        </div>

                        {/* Mobile Tabs */}
                        <div className="px-2 pb-2">
                            <div className="flex space-x-1">
                                {[
                                    { key: 'ank√ºnfte', label: 'Ank√ºnfte', icon: 'üõ¨' },
                                    { key: 'abfl√ºge', label: 'Abfl√ºge', icon: '‚úàÔ∏è' },
                                    { key: 'sichtkontrollen', label: 'Kontrollen', icon: 'üõÇ' },
                                    { key: 'favoriten', label: 'Favoriten', icon: '‚≠ê' }
                                ].map(tab => (
                                    <button
                                        key={tab.key}
                                        onClick={() => setActiveTab(tab.key)}
                                        className={`flex-1 py-2 px-2 rounded-md text-xs font-medium transition-colors ${
                                            activeTab === tab.key
                                                ? 'bg-white text-blue-600 shadow-sm'
                                                : 'text-blue-100 hover:text-white hover:bg-blue-700'
                                        }`}
                                    >
                                        <div className="flex flex-col items-center space-y-0.5">
                                            <span>{tab.icon}</span>
                                            <span className="truncate">{tab.label}</span>
                                        </div>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <div className="px-3 py-4">
                        {/* Sichtkontrollen Filter */}
                        {activeTab === 'sichtkontrollen' && (
                            <div className="mb-4">
                                <button
                                    onClick={() => setShowFilters(!showFilters)}
                                    className="w-full flex justify-between items-center p-3 bg-orange-50 border border-orange-200 rounded-lg"
                                >
                                    <div className="text-left">
                                        <div className="font-semibold text-orange-800 text-sm">üõÇ Sichtkontrollen</div>
                                        <div className="text-xs text-orange-600">
                                            {selectedAirports.size} Flugh√§fen ‚Ä¢ {selectedFlightsForControl.size} Zusatz-Fl√ºge
                                        </div>
                                    </div>
                                    <div className="flex items-center space-x-2">
                                        <Filter className="w-4 h-4 text-orange-600" />
                                        {showFilters ? <ChevronUp className="w-4 h-4" /> : <ChevronDown className="w-4 h-4" />}
                                    </div>
                                </button>

                                {showFilters && (
                                    <div className="mt-3 space-y-3">
                                        <div className="p-3 bg-orange-50 border border-orange-200 rounded-lg">
                                            <h4 className="font-medium text-orange-800 text-sm mb-2">üìç Standard-Flugh√§fen</h4>
                                            <div className="grid grid-cols-2 gap-2 max-h-32 overflow-y-auto">
                                                {Object.entries(DEFAULT_SICHTKONTROLL_AIRPORTS).map(([code, name]) => (
                                                    <label key={code} className="flex items-center space-x-2 p-1.5 hover:bg-orange-100 rounded cursor-pointer">
                                                        <input
                                                            type="checkbox"
                                                            checked={selectedAirports.has(code)}
                                                            onChange={() => toggleAirportForControl(code)}
                                                            className="w-3 h-3 text-orange-600 rounded"
                                                        />
                                                        <div className="text-xs min-w-0 flex-1">
                                                            <div className="font-medium text-gray-900 truncate">{code}</div>
                                                            <div className="text-gray-600 truncate">{name}</div>
                                                        </div>
                                                    </label>
                                                ))}
                                            </div>
                                        </div>

                                        {getArrivingFlights().length > 0 && (
                                            <div className="p-3 bg-green-50 border border-green-200 rounded-lg">
                                                <h4 className="font-medium text-green-800 text-sm mb-2">‚úàÔ∏è Einzelfl√ºge</h4>
                                                <div className="space-y-2 max-h-32 overflow-y-auto">
                                                    {getArrivingFlights().slice(0, 8).map(flight => (
                                                        <label key={flight.id} className="flex items-center space-x-2 p-1.5 hover:bg-green-100 rounded cursor-pointer">
                                                            <input
                                                                type="checkbox"
                                                                checked={selectedFlightsForControl.has(flight.id)}
                                                                onChange={() => toggleFlightForControl(flight.id)}
                                                                className="w-3 h-3 text-green-600 rounded"
                                                            />
                                                            <div className="text-xs min-w-0 flex-1">
                                                                <div className="flex items-center space-x-1">
                                                                    <span className="font-medium text-gray-900">{flight.flugnummer}</span>
                                                                    {flight.land && isNonSchengenCountry(flight.land) && (
                                                                        <span className="px-1 py-0.5 bg-red-100 text-red-600 text-xs rounded-full">NS</span>
                                                                    )}
                                                                </div>
                                                                <div className="text-gray-600 truncate">
                                                                    {flight.herkunft} ‚Ä¢ Gate {flight.gate}
                                                                </div>
                                                            </div>
                                                        </label>
                                                    ))}
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Flight List */}
                        {loading && !realFlights.length ? (
                            <div className="text-center py-12">
                                <RefreshCw className="w-8 h-8 mx-auto mb-4 animate-spin text-blue-500" />
                                <p className="text-sm text-gray-600">Lade echte Flugdaten...</p>
                            </div>
                        ) : error ? (
                            <div className="text-center py-12">
                                <div className="text-red-400 mb-4">
                                    <AlertCircle className="w-12 h-12 mx-auto mb-4" />
                                    <p className="text-base font-medium">Keine Daten verf√ºgbar</p>
                                    <p className="text-sm mt-2 text-gray-600">{error}</p>
                                    <button
                                        onClick={fetchRealFlightData}
                                        className="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                    >
                                        Erneut versuchen
                                    </button>
                                </div>
                            </div>
                        ) : filteredFlights.length > 0 ? (
                            <div>
                                {filteredFlights.map(flug => (
                                    <FlugKarte key={flug.id} flug={flug} />
                                ))}
                            </div>
                        ) : (
                            <div className="text-center py-12">
                                <div className="text-gray-400 mb-4">
                                    <Plane className="w-12 h-12 mx-auto mb-4 opacity-50" />
                                    <p className="text-base">
                                        {activeTab === 'favoriten' && favorites.length === 0
                                            ? 'Keine Favoriten'
                                            : searchTerm
                                            ? 'Keine Fl√ºge gefunden'
                                            : 'Keine Fl√ºge verf√ºgbar'
                                        }
                                    </p>
                                </div>
                            </div>
                        )}

                        {/* Footer */}
                        <div className="mt-8 pt-4 border-t border-gray-200 text-center text-gray-500">
                            <p className="text-xs">
                                D√ºsseldorf Flughafen (DUS) ‚Ä¢ Nur echte Flugdaten
                            </p>
                            <p className="text-xs mt-1">
                                Quelle: AviationStack API
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        // App rendern
        ReactDOM.render(<FlugInfoApp />, document.getElementById('root'));
    </script>
</body>
</html>
